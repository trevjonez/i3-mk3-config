[stepper_i]
step_pin: mmu2:PD6
dir_pin: !mmu2:PG4
enable_pin: !mmu2:PG5
step_distance: 0.05625
endstop_pin: tmc2130_stepper_i:virtual_endstop
position_endstop: 0
position_max: 228
homing_speed: 420
homing_retract_dist: 14

[tmc2130 stepper_i]
cs_pin: mmu2:PB7
microsteps: 32
run_current: .65
hold_current: .35
sense_resistor: 0.220
diag1_pin: !mmu2:PF0
driver_SGT: 6

[stepper_s]
step_pin: mmu2:PD4
dir_pin: mmu2:PG2
enable_pin: !mmu2:PG3
step_distance: .0025
endstop_pin: tmc2130_stepper_s:virtual_endstop
position_endstop: 0
position_max: 73
homing_speed: 5
homing_retract_dist: 1

[tmc2130 stepper_s]
cs_pin: mmu2:PD7
microsteps: 16
run_current: .3
hold_current: .01
sense_resistor: 0.220
diag1_pin: !mmu2:PF1
driver_SGT: 3

[stepper_p]
extruder: 0
step_pin: mmu2:PB4
dir_pin: !mmu2:PG0
enable_pin: !mmu2:PG1
endstop_pin: tmc2130_stepper_p:virtual_endstop
#TODO calibrate that step distance
step_distance: .0025

[tmc2130 stepper_p]
cs_pin: mmu2:PC6
microsteps: 16
run_current: .2
sense_resistor: 0.220
diag1_pin: !mmu2:PF4

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_290037000851363131343032-if00

[mcu mmu2]
serial: /dev/serial/by-id/usb-Klipper_atmega32u4_12345-if00

[filament_selector]
kinematics: mmu2
size: 5
max_i_velocity: 120
max_i_accel: 240
interval_i: 40
#Idler: Path[0] = 14°, Path[N] = Path[N-1] + 40°
# 14° for path zero expressed via stepper_i.homing_retract_dist
max_s_velocity: 12
max_s_accel: 200
interval_s: 14
#Selector: Path[0] = 1mm, Path[N] = Path[N-1] + 14mm
# 1mm for path zero expressed via stepper_s.homing_retract_dist
sensor_pin: mmu2:PF6

[printer]
kinematics: none
max_velocity: 200
max_accel: 1250
max_z_velocity: 12
max_z_accel: 200

[board_pins]
aliases:
# EXP1 header
    EXP1_1=PC9, EXP1_2=PA8,
    EXP1_3=PC11, EXP1_4=PD2,
    EXP1_5=PC10, EXP1_6=PC12,    # Slot in the socket on this side
    EXP1_7=PD0, EXP1_8=PD1,
    EXP1_9=<GND>, EXP1_10=<5V>,

# EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PC6, EXP2_4=PA4,
    EXP2_5=PC7, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PB10, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=<5V>

[display]
lcd_type: st7920
cs_pin: EXP1_4
sclk_pin: EXP1_5
sid_pin: EXP1_3
encoder_pins: ^EXP2_5, ^EXP2_3
click_pin: ^!EXP1_2
#kill_pin: ^!EXP2_8

[output_pin beeper]
pin: EXP1_1
