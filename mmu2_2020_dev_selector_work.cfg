[stepper_i]
step_pin: mmu2:PD6
dir_pin: !mmu2:PG4
enable_pin: !mmu2:PG5
step_distance: 0.05625
endstop_pin: tmc2130_stepper_i:virtual_endstop
position_endstop: 0
position_max: 228
homing_speed: 420
homing_retract_dist: 14

[tmc2130 stepper_i]
cs_pin: mmu2:PB7
microsteps: 32
run_current: .65
hold_current: .35
sense_resistor: 0.220
diag1_pin: !mmu2:PF0
driver_SGT: 6
driver_SFILT: true
driver_PWM_GRAD: 15
driver_PWM_AMPL: 255

[stepper_s]
step_pin: mmu2:PD4
dir_pin: mmu2:PG2
enable_pin: !mmu2:PG3
step_distance: .0025
endstop_pin: tmc2130_stepper_s:virtual_endstop
position_endstop: 0
position_max: 73
homing_speed: 5
homing_retract_dist: 1

[tmc2130 stepper_s]
cs_pin: mmu2:PD7
microsteps: 16
run_current: .3
hold_current: .01
sense_resistor: 0.220
diag1_pin: !mmu2:PF1
driver_SGT: 3
driver_TOFF: 3
driver_HEND: 1
driver_HSTRT: 5
driver_PWM_FREQ: 2
driver_PWM_GRAD: 4
driver_PWM_AMPL: 200
driver_PWM_AUTOSCALE: True

[stepper_p]
step_pin: mmu2:PB4
dir_pin: !mmu2:PG0
enable_pin: !mmu2:PG1
endstop_pin: tmc2130_stepper_p:virtual_endstop
#TODO calibrate that step distance
step_distance: .0025

[tmc2130 stepper_p]
cs_pin: mmu2:PC6
microsteps: 16
run_current: .2
sense_resistor: 0.220
diag1_pin: !mmu2:PF4

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_290037000851363131343032-if00

[mcu mmu2]
serial: /dev/serial/by-id/usb-Klipper_atmega32u4_12345-if00

[filament_selector]
kinematics: mmu2
size: 5
extruder: 0
max_i_velocity: 120
max_i_accel: 240
#Idler: P[0] = 14°, P[N] = P[N-1] + 40°
interval_i: 40
max_s_velocity: 12
max_s_accel: 200
#Selector: P[0] = 1mm, P[N] = P[N-1] + 14mm
interval_s: 14
sensor_pin: mmu2:PF6

[printer]
kinematics: cartesian
max_velocity: 200
max_accel: 1250
max_z_velocity: 12
max_z_accel: 200
